# Milestone v2.1: Adversary Agent

**Status:** SHIPPED 2026-02-13
**Phases:** 1-5
**Total Plans:** 6

## Overview

Adversarial review agent that challenges assumptions and stress-tests feasibility at four key checkpoints in the GSD workflow: requirements, roadmap, plans, and verification. The agent integrates into existing commands without disrupting workflows, enabled via configuration toggle. Research-backed patterns (structured critique, constructive stance, adaptive convergence) prevent common multi-agent debate failures.

## Phases

### Phase 1: Core Agent

**Goal**: Adversary agent can challenge artifacts with structured, constructive feedback
**Depends on**: Nothing (first phase)
**Requirements**: AGENT-01, AGENT-02, AGENT-03, CONV-02
**Success Criteria**:
  1. Adversary can be spawned via Task tool with artifact content and checkpoint type
  2. Adversary returns structured challenges with severity classification (BLOCKING/MAJOR/MINOR)
  3. Adversary adapts challenge focus based on checkpoint type (requirements vs roadmap vs plan vs verification)
  4. Adversary uses constructive tone in all challenges ("Potential risk..." not "This is wrong")
  5. Adversary assesses previous defense rounds and recommends convergence or continuation
**Plans:** 1 plan

Plans:
- [x] 01-01-PLAN.md — Create gsd-adversary agent with challenge generation, convergence logic, and guardrails

**Completed:** 2026-02-02 (19 min)

### Phase 2: Configuration

**Goal**: Users can control adversary behavior through config.json settings
**Depends on**: Nothing (can parallel Phase 1)
**Requirements**: CONF-01, CONF-02, CONF-03
**Success Criteria**:
  1. User can enable/disable adversary globally via config.json "adversary" toggle
  2. User can configure max debate rounds in config.json
  3. User can toggle individual checkpoints on/off in config.json (requirements, roadmap, plan, verification)
**Plans:** 2 plans

Plans:
- [x] 02-01-PLAN.md — Define adversary config schema in template and planning-config reference
- [x] 02-02-PLAN.md — Wire adversary config into new-project, settings, and docs

**Completed:** 2026-02-13 (3 min)

### Phase 3: New-Project Integration

**Goal**: /gsd:new-project invokes adversary at requirements and roadmap checkpoints
**Depends on**: Phase 1, Phase 2
**Requirements**: INTG-01, INTG-02, CONV-01
**Success Criteria**:
  1. Adversary challenges REQUIREMENTS.md after creation in /gsd:new-project (if enabled)
  2. Adversary challenges ROADMAP.md after creation in /gsd:new-project (if enabled)
  3. Debate loop runs until convergence or max rounds reached (hard cap at 3)
  4. User sees adversary challenges and Claude's responses in output
**Plans:** 1 plan

Plans:
- [x] 03-01-PLAN.md — Integrate adversary debate loop at requirements and roadmap checkpoints

**Completed:** 2026-02-13 (7 min)

### Phase 4: Plan Integration

**Goal**: /gsd:plan-phase invokes adversary after plan creation
**Depends on**: Phase 3 (reuses debate loop patterns)
**Requirements**: INTG-03
**Success Criteria**:
  1. Adversary challenges PLAN.md after creation in /gsd:plan-phase (if enabled)
  2. Plan is updated based on valid adversary challenges before commit
**Plans:** 1 plan

Plans:
- [x] 04-01-PLAN.md — Integrate per-plan adversary review loop with planner-as-defender pattern

**Completed:** 2026-02-13 (3 min)

### Phase 5: Verification Integration

**Goal**: /gsd:verify-work invokes adversary to challenge verification conclusions
**Depends on**: Phase 4 (same patterns)
**Requirements**: INTG-04
**Success Criteria**:
  1. Adversary challenges verification conclusions after VERIFICATION.md created (if enabled)
  2. Verification summary reflects consideration of adversary challenges
**Plans:** 1 plan

Plans:
- [x] 05-01-PLAN.md — Integrate adversary verification review into execute-phase step 7.5 with verifier-as-defender

**Completed:** 2026-02-13 (3 min)

---

## Milestone Summary

**Key Decisions:**
- Stateless rounds: Each invocation receives full context, no history tracking
- Advisory role: Adversary informs, orchestrator decides — prevents gridlock
- Minimum one challenge: "Nothing is perfect" ensures adversary always provides value
- Constructive tone: "Potential risk..." phrasing reduces defensive responses
- Adversary opt-out: Enabled by default, missing config = system defaults
- Node-e config parsing: Polymorphic checkpoint values need real JSON parser
- Three-tier precedence: checkpoint > adversary > system default (3)
- Planner-as-defender: Re-spawn planner for revisions instead of inline editing
- Verifier-as-defender: Re-spawn verifier for targeted re-examination
- Post-adversary status re-read: Catches status downgrades from re-examination

**Issues Resolved:**
- Step 11 routing bug: Checker VERIFICATION PASSED routed to step 13, skipping adversary. Fixed to route to step 12.5.

**Issues Deferred:**
- Runtime human verification testing (16 items across phases)
- Installed files at ~/.claude/ outdated relative to source

**Technical Debt Incurred:**
- Project's own .planning/config.json lacks adversary section (system defaults apply)

---

_For current project status, see .planning/MILESTONES.md_
