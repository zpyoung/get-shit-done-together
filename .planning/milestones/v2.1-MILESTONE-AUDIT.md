---
milestone: v2.1
audited: 2026-02-13
status: tech_debt
scores:
  requirements: 12/12
  phases: 5/5
  integration: 9/9
  flows: 6/6
gaps: []
tech_debt:
  - phase: 03-new-project-integration
    items:
      - "human_needed: 5 runtime behaviors require human testing (adversary banner display, debate execution, skip logic, CONV-01 enforcement, artifact cleanliness)"
  - phase: 01-core-agent
    items:
      - "human_needed: 7 integration-era human verification items (spawning/response, multi-round debate, checkpoint adaptation, tone, convergence accuracy, anti-sycophancy, anti-gridlock)"
  - phase: 04-plan-integration
    items:
      - "human_needed: 4 runtime behaviors require human testing (e2e adversary flow, skip paths, planner-as-defender quality, pattern consistency with Phase 3)"
  - phase: 05-verification-integration
    items:
      - "Installed files at ~/.claude/ are outdated (source code verified, pnpm dev:local needed to deploy)"
  - phase: project-config
    items:
      - "Project's own .planning/config.json lacks adversary section (created before v2.1; defaults apply)"
---

# v2.1 Milestone Audit: Adversary Agent

**Milestone:** v2.1 Adversary Agent
**Audited:** 2026-02-13
**Status:** tech_debt

## Requirements Coverage

All 12 v2.1 requirements satisfied:

| Requirement | Description | Phase | Status |
|-------------|-------------|-------|--------|
| AGENT-01 | Constructive stance | Phase 1 | Satisfied |
| AGENT-02 | Severity classification (BLOCKING/MAJOR/MINOR) | Phase 1 | Satisfied |
| AGENT-03 | Checkpoint-type adaptation | Phase 1 | Satisfied |
| CONV-01 | Max 3 rounds hard cap | Phases 3, 4, 5 | Satisfied |
| CONV-02 | Adaptive convergence detection | Phase 1 | Satisfied |
| INTG-01 | Adversary challenges REQUIREMENTS.md | Phase 3 | Satisfied |
| INTG-02 | Adversary challenges ROADMAP.md | Phase 3 | Satisfied |
| INTG-03 | Adversary challenges PLAN.md | Phase 4 | Satisfied |
| INTG-04 | Adversary challenges verification | Phase 5 | Satisfied |
| CONF-01 | Global toggle in config.json | Phase 2 | Satisfied |
| CONF-02 | Max rounds configurable | Phase 2 | Satisfied |
| CONF-03 | Per-checkpoint toggles | Phase 2 | Satisfied |

**Score:** 12/12 requirements satisfied

## Phase Verification

| Phase | Goal | Truths | Status | Verified |
|-------|------|--------|--------|----------|
| 1. Core Agent | Adversary agent with structured challenges | 5/5 | passed | 2026-02-02 |
| 2. Configuration | Config.json adversary settings | 8/8 | passed | 2026-02-13 |
| 3. New-Project Integration | Adversary at requirements + roadmap checkpoints | 5/5 | human_needed | 2026-02-13 |
| 4. Plan Integration | Per-plan adversary review | 8/8 | passed | 2026-02-13 |
| 5. Verification Integration | Adversary at verification checkpoint | 5/5 | passed | 2026-02-13 |

**Score:** 5/5 phases structurally verified (31/31 truths across all phases)

## Cross-Phase Integration

| Integration Point | Status |
|-------------------|--------|
| Phase 1 agent → Phase 3/4/5 orchestrators (output format match) | Connected |
| Phase 2 config → Phase 3/4/5 config reading (identical pattern) | Connected |
| Phase 3 debate loop → Phase 4/5 reuse (consistent patterns) | Connected |
| CONV-01 hard cap → all 4 checkpoints (arithmetic clamp) | Connected |
| Model table entries → all 3 orchestrators (sonnet/sonnet/haiku) | Connected |
| Severity classification → orchestrator challenge handling | Connected |
| Convergence logic → loop exit decisions | Connected |
| Planner-as-defender (Phase 4) → Verifier-as-defender (Phase 5) | Connected |
| Post-adversary status re-read → routing accuracy (Phase 5) | Connected |

**Score:** 9/9 integration points connected, 0 orphaned, 0 missing

## E2E User Flows

| Flow | Status |
|------|--------|
| New project with adversary review (requirements + roadmap) | Complete |
| Plan phase with per-plan adversary review + planner revision | Complete |
| Execute phase with verification adversary review + status re-read | Complete |
| Global disable → all checkpoints skip | Complete |
| Per-checkpoint disable → selective skip | Complete |
| Settings change → config update → commands respect | Complete |

**Score:** 6/6 flows verified

## Anti-Patterns

No anti-patterns found in any phase. All scans returned clean:
- 0 TODO/FIXME comments
- 0 placeholder content
- 0 empty implementations
- 0 stub patterns

## Tech Debt

No critical blockers. Accumulated items requiring attention:

### Runtime Testing (Human Verification)

**Phase 3** (human_needed status) — 5 items:
1. Enable adversary, run `/gsd:new-project` — verify banner + challenges appear after requirements
2. Continue through roadmap — verify banner + challenges appear after roadmap
3. Disable adversary — verify no banners, flow proceeds directly
4. Set max_rounds > 3 — verify hard cap at 3 rounds
5. Check REQUIREMENTS.md and ROADMAP.md — verify no adversary metadata in artifacts

**Phase 1** — 7 items deferred to integration testing:
1. Spawn gsd-adversary via Task tool, verify response structure
2. Run 3-round debate, verify defense assessment
3. Challenge same artifact at different checkpoints, verify focus differs
4. Review tone for constructive phrasing
5. Verify convergence after adequate defense
6. Test anti-sycophancy with weak defense
7. Test anti-gridlock with valid rejection

**Phase 4** — 4 items:
1. E2E adversary review flow with real phase
2. Skip paths (--skip-verify, disabled, --gaps)
3. Planner-as-defender revision quality
4. Pattern consistency with Phase 3

### Deployment

- Installed files at `~/.claude/` are outdated relative to source. Run `pnpm dev:local` to deploy updated commands with adversary integration.

### Project Config

- Project's own `.planning/config.json` predates v2.1 and lacks the `adversary` section. System defaults apply (adversary enabled, max 3 rounds, all checkpoints on). Run `/gsd:settings` to explicitly configure if desired.

## Key Decisions Made

| Decision | Rationale | Phase |
|----------|-----------|-------|
| Single agent with checkpoint adaptation | Reduces maintenance, patterns apply universally | Phase 1 |
| Advisory-only (never blocking) | Prevents workflow deadlock | Phase 1 |
| Constructive tone mandate | Reduces defensive responses | Phase 1 |
| Enabled by default (opt-out) | Missing config = system defaults | Phase 2 |
| node -e for config parsing | Polymorphic values can't be grep'd | Phase 2 |
| Three-tier precedence chain | Checkpoint > adversary > system default | Phase 2 |
| Orchestrator inline defense (Phase 3) | Simple artifacts, no domain expertise needed | Phase 3 |
| Planner-as-defender (Phase 4) | Plan revision requires plan-level knowledge | Phase 4 |
| Verifier-as-defender (Phase 5) | Verification re-examination requires verification expertise | Phase 5 |
| Status re-read after adversary (Phase 5) | Catches status downgrades from verifier re-examination | Phase 5 |

## Files Delivered

| File | Phase | Lines | Purpose |
|------|-------|-------|---------|
| `agents/gsd-adversary.md` | 1 | 351 | Adversary agent definition |
| `get-shit-done/templates/config.json` | 2 | 45 | Config template with adversary section |
| `get-shit-done/references/planning-config.md` | 2 | 295 | Config schema + reading block |
| `commands/gsd/new-project.md` | 2, 3 | 1408 | Requirements + roadmap checkpoints |
| `commands/gsd/settings.md` | 2 | 208 | Adversary settings management |
| `commands/gsd/plan-phase.md` | 4 | 766 | Per-plan adversary review |
| `commands/gsd/execute-phase.md` | 5 | 532 | Verification adversary review |
| `docs/reference/templates.md` | 2 | 399 | User-facing documentation |

---
*Audited: 2026-02-13*
*Integration checker: gsd-integration-checker (sonnet)*
